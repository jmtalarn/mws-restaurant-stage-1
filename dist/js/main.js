let restaurants,neighborhoods,cuisines;var map,markers=[];document.addEventListener("DOMContentLoaded",e=>{fetchNeighborhoods(),fetchCuisines()});const fetchNeighborhoods=()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=(e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})},fetchCuisines=()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=(e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})};window.initMap=(()=>{self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()});const updateRestaurants=()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,s=t.selectedIndex,r=e[n].value,a=t[s].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,a,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e},fillRestaurantsHTML=(e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=e=>{const t=document.createElement("li");t.setAttribute("role","listitem"),t.setAttribute("tabindex","0");const n=`li_title_${e.name.replace(/\s/g,"_")}`;t.setAttribute("aria-labelledby",n);const s=document.createElement("img");s.className="restaurant-img",s.setAttribute("alt",`This is a representative image of the restaurant ${e.name}`),s.setAttribute("tabindex","0"),s.title=`${e.name}`;const r=DBHelper.imageUrlForRestaurant(e);console.log(r),s.src=`${r}-small.jpg`,t.append(s);const a=document.createElement("div");a.className="restaurant-description";const o=document.createElement("h2");o.id=n,o.innerHTML=e.name,a.append(o);const l=document.createElement("p");l.innerHTML=e.neighborhood,a.append(l);const i=document.createElement("p");i.innerHTML=e.address,a.append(i);const c=document.createElement("a");return c.innerHTML="View Details",c.href=DBHelper.urlForRestaurant(e),a.append(c),t.append(a),t},addMarkersToMap=(e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),self.markers.push(t)})};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL21haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJtYXAiLCJtYXJrZXJzIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJmZXRjaE5laWdoYm9yaG9vZHMiLCJmZXRjaEN1aXNpbmVzIiwiREJIZWxwZXIiLCJlcnJvciIsImNvbnNvbGUiLCJzZWxmIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwic2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JFYWNoIiwibmVpZ2hib3Job29kIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInZhbHVlIiwiYXBwZW5kIiwiZmlsbEN1aXNpbmVzSFRNTCIsImN1aXNpbmUiLCJ3aW5kb3ciLCJpbml0TWFwIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsInpvb20iLCJjZW50ZXIiLCJsYXQiLCJsbmciLCJzY3JvbGx3aGVlbCIsInVwZGF0ZVJlc3RhdXJhbnRzIiwiY1NlbGVjdCIsIm5TZWxlY3QiLCJjSW5kZXgiLCJzZWxlY3RlZEluZGV4IiwibkluZGV4IiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJtIiwic2V0TWFwIiwidWwiLCJyZXN0YXVyYW50IiwiY3JlYXRlUmVzdGF1cmFudEhUTUwiLCJhZGRNYXJrZXJzVG9NYXAiLCJsaSIsInNldEF0dHJpYnV0ZSIsInRpdGxlX2lkIiwibmFtZSIsInJlcGxhY2UiLCJpbWFnZSIsImNsYXNzTmFtZSIsInRpdGxlIiwiaW1hZ2VTcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJsb2ciLCJzcmMiLCJkaXYiLCJpZCIsImFkZHJlc3MiLCJtb3JlIiwiaHJlZiIsInVybEZvclJlc3RhdXJhbnQiLCJtYXJrZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwiYWRk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S2pDLFVBQVkyQixFQUFXTSxLQUM1QlMsRUFBSXhDLE9BQU8rQixHQUVYLE1BQU1wQyxFQUFlYixTQUFTZSxjQUFjLEtBQzVDRixFQUFhRyxVQUFZMkIsRUFBVzlCLGFBQ3BDNkMsRUFBSXhDLE9BQU9MLEdBRVgsTUFBTStDLEVBQVU1RCxTQUFTZSxjQUFjLEtBQ3ZDNkMsRUFBUTVDLFVBQVkyQixFQUFXaUIsUUFDL0JGLEVBQUl4QyxPQUFPMEMsR0FFWCxNQUFNQyxFQUFPN0QsU0FBU2UsY0FBYyxLQU9wQyxPQU5BOEMsRUFBSzdDLFVBQVksZUFDakI2QyxFQUFLQyxLQUFPekQsU0FBUzBELGlCQUFpQnBCLEdBQ3RDZSxFQUFJeEMsT0FBTzJDLEdBRVhmLEVBQUc1QixPQUFPd0MsR0FFSFosR0FNTEQsZ0JBQWtCLENBQUNsRCxFQUFjYSxLQUFLYixlQUN4Q0EsRUFBWWlCLFFBQVErQixJQUVoQixNQUFNcUIsRUFBUzNELFNBQVM0RCx1QkFBdUJ0QixFQUFZbkMsS0FBS1YsS0FDaEV5QixPQUFPQyxLQUFLdEIsTUFBTWdFLFlBQVlGLEVBQVEsUUFBUyxLQUMzQzNDLE9BQU84QyxTQUFTTCxLQUFPRSxFQUFPSSxNQUVsQzVELEtBQUtULFFBQVFzRSxLQUFLTCIsImZpbGUiOiJqcy9tYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypnbG9iYWwgZ29vZ2xlIERCSGVscGVyKi9cclxubGV0IHJlc3RhdXJhbnRzLFxyXG4gICAgbmVpZ2hib3Job29kcyxcclxuICAgIGN1aXNpbmVzO1xyXG52YXIgbWFwXHJcbnZhciBtYXJrZXJzID0gW11cclxuXHJcblxyXG4vKipcclxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XHJcbiAgICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcclxuICAgIGZldGNoQ3Vpc2luZXMoKTtcclxufSk7XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgYW5kIHNldCB0aGVpciBIVE1MLlxyXG4gKi9cclxuY29uc3QgZmV0Y2hOZWlnaGJvcmhvb2RzID0gKCkgPT4ge1xyXG4gICAgREJIZWxwZXIuZmV0Y2hOZWlnaGJvcmhvb2RzKChlcnJvciwgbmVpZ2hib3Job29kcykgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3JcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5uZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcztcclxuICAgICAgICAgICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxyXG4gKi9cclxuY29uc3QgZmlsbE5laWdoYm9yaG9vZHNIVE1MID0gKG5laWdoYm9yaG9vZHMgPSBzZWxmLm5laWdoYm9yaG9vZHMpID0+IHtcclxuICAgIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG4gICAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICAgICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZDtcclxuICAgICAgICBvcHRpb24udmFsdWUgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICAgICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBhbGwgY3Vpc2luZXMgYW5kIHNldCB0aGVpciBIVE1MLlxyXG4gKi9cclxuY29uc3QgZmV0Y2hDdWlzaW5lcyA9ICgpID0+IHtcclxuICAgIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcclxuICAgICAgICAgICAgZmlsbEN1aXNpbmVzSFRNTCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogU2V0IGN1aXNpbmVzIEhUTUwuXHJcbiAqL1xyXG5jb25zdCBmaWxsQ3Vpc2luZXNIVE1MID0gKGN1aXNpbmVzID0gc2VsZi5jdWlzaW5lcykgPT4ge1xyXG4gICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG5cclxuICAgIGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICAgICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XHJcbiAgICAgICAgb3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcclxuICAgICAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuICovXHJcbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gICAgbGV0IGxvYyA9IHtcclxuICAgICAgICBsYXQ6IDQwLjcyMjIxNixcclxuICAgICAgICBsbmc6IC03My45ODc1MDFcclxuICAgIH07XHJcbiAgICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcbiAgICAgICAgem9vbTogMTIsXHJcbiAgICAgICAgY2VudGVyOiBsb2MsXHJcbiAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXHJcbiAgICB9KTtcclxuICAgIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxyXG4gKi9cclxuY29uc3QgdXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XHJcbiAgICBjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG4gICAgY29uc3QgblNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG5cclxuICAgIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuICAgIGNvbnN0IG5JbmRleCA9IG5TZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuXHJcbiAgICBjb25zdCBjdWlzaW5lID0gY1NlbGVjdFtjSW5kZXhdLnZhbHVlO1xyXG4gICAgY29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xyXG5cclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcclxuICAgICAgICAgICAgZmlsbFJlc3RhdXJhbnRzSFRNTCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXHJcbiAqL1xyXG5jb25zdCByZXNldFJlc3RhdXJhbnRzID0gKHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAvLyBSZW1vdmUgYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBzZWxmLnJlc3RhdXJhbnRzID0gW107XHJcbiAgICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgICB1bC5pbm5lckhUTUwgPSAnJztcclxuXHJcbiAgICAvLyBSZW1vdmUgYWxsIG1hcCBtYXJrZXJzXHJcbiAgICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtID0+IG0uc2V0TWFwKG51bGwpKTtcclxuICAgIHNlbGYubWFya2VycyA9IFtdO1xyXG4gICAgc2VsZi5yZXN0YXVyYW50cyA9IHJlc3RhdXJhbnRzO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmNvbnN0IGZpbGxSZXN0YXVyYW50c0hUTUwgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgICAgIHVsLmFwcGVuZChjcmVhdGVSZXN0YXVyYW50SFRNTChyZXN0YXVyYW50KSk7XHJcbiAgICB9KTtcclxuICAgIGFkZE1hcmtlcnNUb01hcCgpO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cclxuICovXHJcbmNvbnN0IGNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQpID0+IHtcclxuICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgIGxpLnNldEF0dHJpYnV0ZSgncm9sZScsICdsaXN0aXRlbScpO1xyXG4gICAgbGkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XHJcblxyXG4gICAgY29uc3QgdGl0bGVfaWQgPSBgbGlfdGl0bGVfJHtyZXN0YXVyYW50Lm5hbWUucmVwbGFjZSgvXFxzL2csJ18nKX1gO1xyXG5cclxuICAgIGxpLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5JywgdGl0bGVfaWQpO1xyXG4gICAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICAgIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsIGBUaGlzIGlzIGEgcmVwcmVzZW50YXRpdmUgaW1hZ2Ugb2YgdGhlIHJlc3RhdXJhbnQgJHtyZXN0YXVyYW50Lm5hbWV9YCk7XHJcbiAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTtcclxuICAgIGltYWdlLnRpdGxlID0gYCR7cmVzdGF1cmFudC5uYW1lfWA7XHJcbiAgICBjb25zdCBpbWFnZVNyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICAgIGNvbnNvbGUubG9nKGltYWdlU3JjKTtcclxuICAgIGltYWdlLnNyYyA9IGAke2ltYWdlU3JjfS1zbWFsbC5qcGdgO1xyXG5cclxuICAgIGxpLmFwcGVuZChpbWFnZSk7XHJcbiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGRpdi5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1kZXNjcmlwdGlvbic7XHJcbiAgICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcclxuICAgIG5hbWUuaWQgPSB0aXRsZV9pZDtcclxuICAgIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gICAgZGl2LmFwcGVuZChuYW1lKVxyXG5cclxuICAgIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIG5laWdoYm9yaG9vZC5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5laWdoYm9yaG9vZDtcclxuICAgIGRpdi5hcHBlbmQobmVpZ2hib3Job29kKTtcclxuXHJcbiAgICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgICBkaXYuYXBwZW5kKGFkZHJlc3MpO1xyXG5cclxuICAgIGNvbnN0IG1vcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICBtb3JlLmlubmVySFRNTCA9ICdWaWV3IERldGFpbHMnO1xyXG4gICAgbW9yZS5ocmVmID0gREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICAgIGRpdi5hcHBlbmQobW9yZSk7XHJcblxyXG4gICAgbGkuYXBwZW5kKGRpdik7XHJcblxyXG4gICAgcmV0dXJuIGxpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXHJcbiAqL1xyXG5jb25zdCBhZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xyXG4gICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci51cmw7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc2VsZi5tYXJrZXJzLnB1c2gobWFya2VyKTtcclxuICAgIH0pO1xyXG59Il19
